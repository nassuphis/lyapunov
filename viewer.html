<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DeepZoom Viewer</title>

  <!-- OpenSeadragon -->
  <script src="https://cdn.jsdelivr.net/npm/openseadragon@4.1/build/openseadragon/openseadragon.min.js"></script>

  <style>
    html, body { width: 100%; height: 100%; margin: 0; background: #111; }
    #viewer { width: 100vw; height: 100vh; background: #111; }
    #status {
      position: fixed;
      left: 12px;
      bottom: 12px;
      max-width: calc(100vw - 24px);
      padding: 10px 12px;
      border-radius: 8px;
      font: 13px/1.35 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      background: rgba(0,0,0,0.65);
      color: #ddd;
      white-space: pre-wrap;
      z-index: 9999;
    }
  </style>
</head>

<body>
  <div id="viewer"></div>
  <div id="status">Loading…</div>

  <script>
    (function () {
      const statusEl = document.getElementById("status");
      const log = (...args) => {
        console.log(...args);
        statusEl.textContent = args.map(a => (typeof a === "string" ? a : JSON.stringify(a, null, 2))).join("\n");
      };

      // Change this if your .dzi filename differs
      const DZI = "tst.dzi";

      if (typeof OpenSeadragon !== "function") {
        log("ERROR: OpenSeadragon did not load (typeof OpenSeadragon !== 'function').");
        return;
      }

      log("OpenSeadragon loaded. Opening:", DZI);

      const viewer = OpenSeadragon({
        id: "viewer",
        tileSources: DZI, // relative to viewer.html because you're serving the same folder
        prefixUrl: "https://cdn.jsdelivr.net/npm/openseadragon@4.1/build/openseadragon/images/",
        showNavigator: true,
        navigatorPosition: "BOTTOM_RIGHT",
        visibilityRatio: 1.0,
        minZoomLevel: 0.5,
        defaultZoomLevel: 0,
        maxZoomPixelRatio: 4,
        gestureSettingsMouse: {
          scrollToZoom: true
        }
      });

      viewer.addHandler("open", function () {
        const item = viewer.world.getItemAt(0);
        const size = item ? item.getContentSize() : null;
        log(
          size ? `Size: ${size.x} × ${size.y}` : "(no size?)"
        );
      });

      viewer.addHandler("open-failed", function (e) {
        log("OPEN FAILED", e && (e.message || JSON.stringify(e, null, 2)));
      });

      // This helps catch some classes of failures
      viewer.addHandler("tile-load-failed", function (e) {
        log(
          "TILE LOAD FAILED",
          `url: ${e && e.tile && e.tile.url}`,
          e && (e.message || JSON.stringify(e, null, 2))
        );
      });

      // Extra: show errors if the script throws
      window.addEventListener("error", (ev) => {
        log("JS ERROR", ev.message || String(ev.error || ev));
      });
    })();
  </script>
</body>
</html>

